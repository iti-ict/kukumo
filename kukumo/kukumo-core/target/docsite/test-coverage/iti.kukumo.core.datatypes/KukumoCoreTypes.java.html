<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>KukumoCoreTypes.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Kukumo::CORE</a> &gt; <a href="index.source.html" class="el_package">iti.kukumo.core.datatypes</a> &gt; <span class="el_source">KukumoCoreTypes.java</span></div><h1>KukumoCoreTypes.java</h1><pre class="source lang-java linenums">/*
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */

/**
 * @author Luis IÃ±esta Gelabert - linesta@iti.es | luiinge@gmail.com
 */
package iti.kukumo.core.datatypes;


import java.io.File;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.net.URL;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.LocalTime;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import iti.commons.jext.Extension;
import iti.kukumo.api.KukumoDataType;
import iti.kukumo.api.extensions.DataTypeContributor;


@Extension(provider = &quot;iti.kukumo&quot;, name = &quot;core-types&quot;, version = &quot;1.1&quot;)
<span class="fc" id="L30">public class KukumoCoreTypes implements DataTypeContributor {</span>

    public static final String STRING_REGEX = &quot;\&quot;([^\&quot;\\\\]*(\\\\.[^\&quot;\\\\]*)*)\&quot;|'([^'\\\\]*(\\\\.[^'\\\\]*)*)'&quot;;
    public static final String WORD_REGEX = &quot;[\\w-]+&quot;;
    public static final String IDENTIFIER_REGEX = &quot;[\\w|\\d_]+&quot;;
    public static final String FILE_REGEX = &quot;\&quot;([^\&quot;\\\\]*(\\\\.[^\&quot;\\\\]*)*)\&quot;|'([^'\\\\]*(\\\\.[^'\\\\]*)*)'&quot;;
    public static final String URL_REGEX = &quot;(http|ftp|https):\\/\\/([\\w+?\\.\\w+])+([a-zA-Z0-9\\~\\!\\@\\#\\$\\%\\^\\&amp;\\*\\(\\)_\\-\\=\\+\\\\\\/\\?\\.\\:\\;\\'\\,]*)?&quot;;

<span class="pc" id="L38">    private static final KukumoDataTypeBase.LocaleHintProvider PATH_HINT = locale -&gt; Arrays</span>
<span class="nc" id="L39">        .asList(&quot;&lt;path/file&gt;&quot;);</span>
<span class="pc" id="L40">    private static final KukumoDataTypeBase.LocaleHintProvider TEXT_HINT = locale -&gt; Arrays</span>
<span class="nc" id="L41">        .asList(&quot;'&lt;text&gt;'&quot;);</span>
<span class="fc" id="L42">    private static final KukumoDataTypeBase.LocaleHintProvider WORD_HINT = locale -&gt; Arrays</span>
<span class="fc" id="L43">        .asList(&quot;&lt;word&gt;&quot;);</span>
<span class="pc" id="L44">    private static final KukumoDataTypeBase.LocaleHintProvider URL_HINT = locale -&gt; Arrays</span>
<span class="nc" id="L45">        .asList(&quot;http://...&quot;, &quot;https://...&quot;, &quot;ftp://...&quot;);</span>


    @Override
    public List&lt;KukumoDataType&lt;?&gt;&gt; contributeTypes() {
<span class="fc" id="L50">        final ArrayList&lt;KukumoDataType&lt;?&gt;&gt; types = new ArrayList&lt;&gt;();</span>
        // functional datatypes
<span class="fc" id="L52">        types.add(</span>
<span class="fc" id="L53">            KukumoNumberDataType.createFromNumber(&quot;integer&quot;, Long.class, false, Number::longValue)</span>
        );
<span class="fc" id="L55">        types.add(</span>
<span class="pc" id="L56">            KukumoNumberDataType.createFromBigDecimal(&quot;decimal&quot;, BigDecimal.class, true, x -&gt; x)</span>
        );
<span class="fc" id="L58">        types.add(</span>
            new KukumoDataTypeBase&lt;&gt;(
<span class="fc" id="L60">                &quot;text&quot;, String.class, locale -&gt; STRING_REGEX, TEXT_HINT,</span>
<span class="nc" id="L61">                locale -&gt; KukumoCoreTypes::prepareString</span>
            )
        );
<span class="fc" id="L64">        types.add(</span>
            new KukumoDataTypeBase&lt;&gt;(
<span class="pc" id="L66">                &quot;word&quot;, String.class, locale -&gt; WORD_REGEX, WORD_HINT, locale -&gt; (input -&gt; input)</span>
            )
        );
<span class="fc" id="L69">        types.add(</span>
            new KukumoDataTypeBase&lt;&gt;(
<span class="nc" id="L71">                &quot;id&quot;, String.class, locale -&gt; IDENTIFIER_REGEX, WORD_HINT,</span>
<span class="nc" id="L72">                locale -&gt; (input -&gt; input)</span>
            )
        );
<span class="fc" id="L75">        types.add(new KukumoDateDataType&lt;&gt;(&quot;date&quot;, LocalDate.class, true, false, LocalDate::from));</span>
<span class="fc" id="L76">        types.add(new KukumoDateDataType&lt;&gt;(&quot;time&quot;, LocalTime.class, false, true, LocalTime::from));</span>
<span class="fc" id="L77">        types.add(</span>
            new KukumoDateDataType&lt;&gt;(
                &quot;datetime&quot;, LocalDateTime.class, true, true, LocalDateTime::from
            )
        );
        // java datatypes
<span class="fc" id="L83">        types.add(</span>
            new KukumoDataTypeBase&lt;&gt;(
<span class="nc" id="L85">                &quot;string&quot;, String.class, locale -&gt; STRING_REGEX, TEXT_HINT,</span>
<span class="nc" id="L86">                locale -&gt; KukumoCoreTypes::prepareString</span>
            )
        );
<span class="fc" id="L89">        types.add(</span>
<span class="fc" id="L90">            KukumoNumberDataType.createFromNumber(&quot;byte&quot;, Byte.class, false, Number::byteValue)</span>
        );
<span class="fc" id="L92">        types.add(</span>
<span class="fc" id="L93">            KukumoNumberDataType.createFromNumber(&quot;short&quot;, Short.class, false, Number::shortValue)</span>
        );
<span class="fc" id="L95">        types.add(</span>
<span class="fc" id="L96">            KukumoNumberDataType.createFromNumber(&quot;int&quot;, Integer.class, false, Number::intValue)</span>
        );
<span class="fc" id="L98">        types.add(</span>
<span class="fc" id="L99">            KukumoNumberDataType.createFromNumber(&quot;long&quot;, Long.class, false, Number::longValue)</span>
        );
<span class="fc" id="L101">        types.add(</span>
<span class="fc" id="L102">            KukumoNumberDataType.createFromBigDecimal(</span>
                &quot;biginteger&quot;,
                BigInteger.class,
                true,
                BigDecimal::toBigInteger
            )
        );
<span class="fc" id="L109">        types.add(</span>
            KukumoNumberDataType
<span class="fc" id="L111">                .createFromBigDecimal(&quot;float&quot;, Float.class, true, BigDecimal::floatValue)</span>
        );
<span class="fc" id="L113">        types.add(</span>
            KukumoNumberDataType
<span class="fc" id="L115">                .createFromBigDecimal(&quot;double&quot;, Double.class, true, BigDecimal::doubleValue)</span>
        );
<span class="fc" id="L117">        types.add(</span>
<span class="pc" id="L118">            KukumoNumberDataType.createFromBigDecimal(&quot;bigdecimal&quot;, BigDecimal.class, true, x -&gt; x)</span>
        );
        // file datatype
<span class="fc" id="L121">        types.add(</span>
            new KukumoDataTypeBase&lt;&gt;(
<span class="nc" id="L123">                &quot;file&quot;, File.class, locale -&gt; FILE_REGEX, PATH_HINT,</span>
<span class="nc" id="L124">                locale -&gt; file -&gt; new File(prepareString(file))</span>
            )
        );
        // net datatype
<span class="fc" id="L128">        types.add(</span>
            new KukumoDataTypeBase&lt;&gt;(
<span class="nc" id="L130">                &quot;url&quot;, URL.class, locale -&gt; URL_REGEX, URL_HINT, locale -&gt; URL::new</span>
            )
        );
<span class="fc" id="L133">        return types;</span>
    }


    /* remove leading and tailing &quot; or ' , and replace escaped characters */
    private static String prepareString(String input) {
<span class="nc" id="L139">        return input.substring(1, input.length() - 1).replaceAll(&quot;\\\\\&quot;&quot;, &quot;\&quot;&quot;)</span>
<span class="nc" id="L140">            .replaceAll(&quot;\\\\'&quot;, &quot;'&quot;);</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>